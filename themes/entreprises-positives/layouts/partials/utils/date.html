<!-- Required params  -->
<!-- date: the date to format -->
<!-- pattern: same as the dateFormat pattern for hugo (see hugo doc)-->
<!-- context: the context as . -->

<!--Format the date with hugo dateFormat-->
{{$date := dateFormat .pattern .date}}

<!--Check the month type-->
{{$monthtype := ""}}
{{if in .pattern "January"}}
{{$monthtype = "long"}}
{{else if in .pattern "Jan"}}
{{$monthtype = "short"}}
{{end}}

<!--Get our month data from given date-->
{{$monthdata := index .context.Site.Data.date.months (sub (int (printf "%d" .date.Month)) 1)}}

<!--replace the month with our data depending on type-->
{{if eq $monthtype "short"}}
{{$date = replaceRE (dateFormat "Jan" .date) $monthdata.short $date }}
{{else if eq $monthtype "long"}}
{{$date = replaceRE (dateFormat "January" .date) $monthdata.long $date }}
{{end}}

<!--Check the day type -->
{{$daytype := ""}}
{{if in .pattern "Monday"}}
{{$daytype = "long"}}
{{else if in .pattern "Mon"}}
{{$daytype = "short"}}
{{end}}

<!--Get our day data from given date-->
{{$daydata := index .context.Site.Data.date.days (int (printf "%d" .date.Weekday))}}

<!--replace the day with our data depending on type-->
{{if eq $daytype "short"}}
{{$date = replaceRE (dateFormat "Mon" .date) $daydata.short $date }}
{{else if eq $daytype "long"}}
{{$date = replaceRE (dateFormat "Monday" .date) $daydata.long $date }}
{{end}}

<!--print our formatted date using the time html tag as described in hugo documentation-->
<time datetime="{{ .date.Format "2006-01-02T15:04:05Z07:00" | safeHTML }}">
{{$date}}
</time>